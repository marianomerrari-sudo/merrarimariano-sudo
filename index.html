<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine Surprise for Shamsham ‚ù§Ô∏è</title>

<style>
/* BODY AND BACKGROUND */
body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(135deg,#ffdde1,#ee9ca7);
  /* logical property for block size (better for different writing modes) */
  block-size: 100vh;
  height: 100vh;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* INTRO SCREEN */
#intro {
  position: fixed;
  inset: 0;
  background: #ffdde1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  cursor: pointer;
}
#intro h1 {
  color: #e11d48;
  text-align: center;
  font-size: 1.8em;
}
.envelope {
  font-size: 8vw;
  animation: bounce 1.5s infinite;
}
@keyframes bounce { 50% { transform: translateY(-20px); } }

/* CARD */
.card {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  width: 90%;
  max-width: 560px;
  padding: 5vw;
  border-radius: 20px;
  text-align: center;
  box-shadow: 0 25px 50px rgba(0,0,0,.25);
  display: none;
  z-index: 2;
  border: 0.5vw solid #fb7185;
  animation: cardZoom 1s ease forwards;
}
@keyframes cardZoom { from { transform: translate(-50%, -50%) scale(0.9); } to { transform: translate(-50%, -50%) scale(1); } }

h1 { color: #e11d48; margin-bottom: 0.5em; font-size: 1.5em; }
.names { font-size: 1em; color: #be123c; margin-bottom: 1em; }
.message { margin-top: 1em; line-height: 1.7; color: #444; min-height: 10em; font-size: 1em; }

.photo {
  width: 50%;
  max-width: 180px;
  height: auto;
  object-fit: cover;
  border-radius: 50%;
  border: 0.3vw solid #fb7185;
  margin: 1em 0;
  box-shadow: 0 10px 25px rgba(0,0,0,.25);
  animation: photoGlow 2s infinite alternate;
}
@keyframes photoGlow { from { box-shadow: 0 0 20px #fb7185; } to { box-shadow: 0 0 40px #f43f5e; } }

/* BLOOMING FLOWERS */
.flower { position: absolute; bottom: -15vh; width: 15vw; height: 15vw; animation: grow 60s linear forwards; }
.petal { position: absolute; width: 4vw; height: 6vw; background: #fb7185; border-radius: 50% 50% 0 0; left: 35%; top: 20%; opacity: 0; animation: bloom 4s forwards; }
.petal:nth-child(1) { transform: rotate(0deg); animation-delay: 2s; }
.petal:nth-child(2) { transform: rotate(60deg); animation-delay: 3s; }
.petal:nth-child(3) { transform: rotate(120deg); animation-delay: 4s; }
.petal:nth-child(4) { transform: rotate(180deg); animation-delay: 5s; }
.petal:nth-child(5) { transform: rotate(240deg); animation-delay: 6s; }
.petal:nth-child(6) { transform: rotate(300deg); animation-delay: 7s; }
.center { position: absolute; width: 3vw; height: 3vw; background: #fde047; border-radius: 50%; top: 35%; left: 35%; opacity: 0; animation: showCenter 2s forwards; animation-delay: 8s; }
@keyframes bloom { to { opacity:1; transform: scale(1); } }
@keyframes showCenter { to { opacity:1; } }
@keyframes grow { to { transform: translateY(-90vh) scale(1.3); } }

/* INTRO: live blooming flowers while the intro is visible */
#intro .intro-wrap{position:relative;display:flex;flex-direction:column;align-items:center;gap:0.8rem;z-index:18;padding:4vmin 6vmin;max-width:820px;width:100%;box-sizing:border-box;min-height:56vh;justify-content:center}
#intro { overflow: hidden; }
.intro-veil{position:absolute;inset:0;background:radial-gradient(ellipse at center, rgba(255,255,255,0.18) 0%, rgba(255,245,250,0.6) 30%, rgba(255,230,240,0.1) 60%, rgba(0,0,0,0.08) 100%);pointer-events:none}
.intro-vignette{position:absolute;inset:0;pointer-events:none;background:radial-gradient(ellipse at center, rgba(0,0,0,0.0) 40%, rgba(0,0,0,0.22) 100%)}
.intro-flowers { position: absolute; inset: 0; pointer-events: none; z-index:6 }
.intro-flower { position: absolute; bottom: 10%; width: 8vmin; height: 8vmin; transform-origin: 50% 70%; opacity: 0; }
.intro-petal { position: absolute; left: 50%; top: 50%; width: 3vmin; height: 4vmin; background: #ff6b96; border-radius: 50% 50% 40% 40%; transform-origin: bottom center; opacity: 0; }
.intro-center { position: absolute; left: 50%; top: 50%; width: 1.6vmin; height: 1.6vmin; background: #ffd166; border-radius: 50%; transform: translate(-50%,-50%); opacity: 0; }
@keyframes introBloom {
  0% { transform: scale(0.05) translateY(0); opacity: 0; }
  60% { transform: scale(1.05) translateY(-6vmin); opacity: 1; }
  100% { transform: scale(1) translateY(-10vmin); opacity: 0.95; }
}
@keyframes petalOpen { to { opacity: 1; transform: translateX(-50%) rotate(0deg) scale(1); } }
@keyframes petalFloat { to { transform: translateX(-50%) rotate(20deg) translateY(-6vmin); opacity: 0; } }

/* ENVELOPE SHIMMER */
.envelope{position:relative;display:inline-block;z-index:30;font-size:10vmin;margin-bottom:0.25rem}
.envelope::after{content:'';position:absolute;left:-40%;top:-40%;width:180%;height:180%;background:linear-gradient(120deg, rgba(255,255,255,0.0) 0%, rgba(255,255,255,0.7) 50%, rgba(255,255,255,0.0) 100%);transform:translateX(-100%) rotate(8deg);opacity:0.7;pointer-events:none;z-index:-1}
@keyframes shimmer{0%{transform:translateX(-100%) rotate(8deg)}100%{transform:translateX(100%) rotate(8deg)}}
.envelope:hover::after{animation:shimmer 1.6s ease-in-out}

/* INTRO TITLES */
.intro-title{font-family:'Brush Script MT','Lucida Handwriting',cursive;color:#b91c4a;font-size:3rem;margin-top:0.25rem;text-shadow:0 8px 28px rgba(185,28,74,0.16);letter-spacing:0.6px;position:relative;z-index:28}
.intro-sub{font-family:Segoe UI, system-ui, -apple-system, 'Helvetica Neue', Arial;color:#7f1d3a;font-size:1rem;margin-top:0.15rem;opacity:0.95;position:relative;z-index:28}

/* SOFT FLOATING HEARTS (intro only) */
.intro-heart{position:absolute;font-size:1.05rem;opacity:0.9;pointer-events:none;transform:translateY(0);transition:transform 3s linear, opacity 3s linear}
.intro-cta{margin-top:0.8rem;padding:0.5rem 1.1rem;border-radius:999px;background:linear-gradient(90deg,#ff6b96,#ff4d85);color:white;font-weight:700;box-shadow:0 8px 28px rgba(255,77,133,0.18)}


/* FALLING ROSES */
.rose { position: absolute; top: -5vh; font-size: 4vw; animation: fall linear infinite; }
@keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }

/* FLOATING HEARTS */
.heart { position: absolute; font-size: 4vw; opacity: 0.7; animation: floatHeart 5s linear infinite; }
@keyframes floatHeart { to { transform: translateY(-100vh); opacity: 0; } }

/* SPARKLES */
.sparkle { position: absolute; width: 0.5vw; height: 0.5vw; background: #fde047; border-radius: 50%; opacity: 0.8; animation: sparkleAnim 4s linear infinite; }
@keyframes sparkleAnim { 50% { transform: scale(2); opacity: 0.4; } 100% { transform: translateY(-100vh); opacity:0; } }

/* FLOWER BOUQUET */
.bouquet { position: absolute; bottom: 5vh; right: 5vw; width: 20vw; max-width: 200px; height: 40vh; max-height: 400px; display: flex; flex-direction: column; align-items: center; justify-content: flex-end; animation: bounceIn 1.5s ease forwards; }
.bouquet-stem { width: 2vw; height: 25vh; background: linear-gradient(90deg, #2d5016, #3d7527); border-radius: 10px 10px 0 0; position: relative; }
.bouquet-stems { position: absolute; width: 100%; height: 100%; }
.stem { position: absolute; width: 0.5vw; height: 20vh; background: #2d5016; border-radius: 50%; transform-origin: top; }
.stem:nth-child(1) { left: 0; transform: rotate(-15deg); }
.stem:nth-child(2) { left: 2.5vw; transform: rotate(15deg); }
.stem:nth-child(3) { left: 1.25vw; }
.flowers { position: relative; width: 18vw; height: 18vw; max-width: 180px; max-height: 180px; }
.flower-head { font-size: 4vw; position: absolute; animation: flowerSway 3s ease-in-out infinite; }
.flower-head:nth-child(1) { top: -2vw; left: 2vw; animation-delay: 0s; }
.flower-head:nth-child(2) { top: 1vw; left: 6vw; animation-delay: 0.3s; }
.flower-head:nth-child(3) { top: 0vw; left: 0vw; animation-delay: 0.6s; }
.flower-head:nth-child(4) { top: 3vw; left: 10vw; animation-delay: 0.9s; }
.flower-head:nth-child(5) { top: 5vw; left: 4vw; animation-delay: 1.2s; }
.flower-head:nth-child(6) { top: 6vw; left: 8vw; animation-delay: 1.5s; }
.ribbon { position: absolute; bottom: -2vw; left: 50%; transform: translateX(-50%); width: 80%; height: 3vw; background: linear-gradient(90deg, #ff69b4, #ff1493, #ff69b4); border-radius: 50%; opacity: 0.8; }
@keyframes flowerSway { 0%, 100% { transform: translateY(0) rotate(-5deg); } 50% { transform: translateY(-0.5vw) rotate(5deg); } }
@keyframes bounceIn { from { transform: translateY(50vh) scale(0.5); opacity: 0; } to { transform: translateY(0) scale(1); opacity: 1; } }

/* OUTRO CARD */
#outro {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  width: 90%;
  max-width: 560px;
  padding: 5vw;
  border-radius: 20px;
  text-align: center;
  box-shadow: 0 25px 50px rgba(0,0,0,.25);
  display: none;
  z-index: 3;
  border: 0.5vw solid #fb7185;
  animation: cardZoom 1s ease forwards;
}
#outro h2 {
  color: #e11d48;
  font-size: 1.3em;
  margin-bottom: 0.8em;
}
#outro p {
  color: #666;
  line-height: 1.8;
  font-size: 0.95em;
  margin-bottom: 1.5em;
}
.outro-buttons {
  display: flex;
  gap: 1em;
  justify-content: center;
  flex-wrap: wrap;
}

/* OUTRO GAME */
.game-area{margin-top:1em;background:linear-gradient(180deg, #fffafc, #fff2f6);border:1px solid #ffe4ed;border-radius:12px;padding:1rem;display:flex;flex-direction:column;align-items:center;gap:0.8rem}
.game-playfield{position:relative;width:100%;max-width:420px;height:220px;border-radius:10px;overflow:hidden;background:linear-gradient(180deg,#fff,#fff3f6);box-shadow:inset 0 6px 18px rgba(235,87,132,0.04)}
.game-controls{display:flex;gap:0.6rem;align-items:center}
.game-score{font-weight:700;color:#b91c4a}
.game-heart{position:absolute;font-size:1.4rem;cursor:pointer;transform:translateY(0);transition:transform 600ms cubic-bezier(.2,.9,.3,1),opacity 600ms}
.game-final{padding:0.6rem 0.8rem;border-radius:10px;background:#fff;box-shadow:0 6px 18px rgba(0,0,0,0.06);display:flex;gap:0.6rem;align-items:center}

/* EXIT BUTTON */
.exit-btn {
  background: #e11d48;
  color: white;
  border: none;
  padding: 0.8em 1.5em;
  border-radius: 25px;
  font-size: 1em;
  cursor: pointer;
  margin-top: 1em;
  transition: all 0.3s ease;
  font-weight: bold;
}
.exit-btn:hover {
  background: #be123c;
  transform: scale(1.05);
  box-shadow: 0 5px 15px rgba(225, 29, 72, 0.4);
}
.exit-btn:active {
  transform: scale(0.95);
}

.back-btn {
  background: #9ca3af;
  color: white;
  border: none;
  padding: 0.8em 1.5em;
  border-radius: 25px;
  font-size: 1em;
  cursor: pointer;
  transition: all 0.3s ease;
  font-weight: bold;
}
.back-btn:hover {
  background: #6b7280;
  transform: scale(1.05);
}

.goodbye-btn {
  background: #ec4899;
  color: white;
  border: none;
  padding: 0.8em 1.5em;
  border-radius: 25px;
  font-size: 1em;
  cursor: pointer;
  transition: all 0.3s ease;
  font-weight: bold;
}
.goodbye-btn:hover {
  background: #db2777;
  transform: scale(1.05);
}

/* TEMPLATE SELECTOR */
#template-select {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  width: 90%;
  max-width: 560px;
  padding: 5vw;
  border-radius: 20px;
  text-align: center;
  box-shadow: 0 25px 50px rgba(0,0,0,.25);
  display: none;
  z-index: 4;
  border: 0.5vw solid #fb7185;
  animation: cardZoom 1s ease forwards;
}
#template-select h2 {
  color: #e11d48;
  font-size: 1.3em;
  margin-bottom: 1em;
}
.template-options {
  display: flex;
  flex-direction: column;
  gap: 0.8em;
  margin-bottom: 1.5em;
}
.template-btn {
  background: #f3f4f6;
  color: #333;
  border: 2px solid #ddd;
  padding: 1em;
  border-radius: 12px;
  font-size: 1em;
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: left;
  font-weight: 500;
}
.template-btn:hover {
  background: #e5e7eb;
  border-color: #e11d48;
  transform: translateX(5px);
}
.template-btn.active {
  background: #e11d48;
  color: white;
  border-color: #e11d48;
}
.template-btn small {
  display: block;
  font-size: 0.85em;
  opacity: 0.7;
  margin-top: 5px;
}

/* MEDIA QUERIES */
@media (max-width: 600px) {
  .card { padding: 5vw; }
  h1 { font-size: 1.2em; }
  .names, .message { font-size: 0.9em; }
  .photo { max-width: 35vw; }
  .flower { width: 25vw; height: 25vw; }
  .petal { width: 6vw; height: 8vw; }
  .center { width: 4vw; height: 4vw; }
}

/* TEMPLATE PREVIEW IN INTRO */
.template-preview { position:relative; margin-top:2.2rem; width: min(48vw,420px); padding: 1rem; border-radius: 14px; background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,245,250,0.85)); box-shadow: 0 10px 30px rgba(0,0,0,0.12); display:flex; gap:0.8rem; align-items:center; justify-content:space-between; pointer-events:auto; cursor:pointer; backdrop-filter: blur(6px); z-index:12 }
.preview-left { display:flex; gap:0.8rem; align-items:center; }
.preview-icon { font-size:2.2rem; transform-origin:center; animation: previewPulse 2s ease-in-out infinite; }
.preview-text { font-size:0.95rem; color:#9f1239; font-weight:600; }
.preview-sub { font-size:0.78rem; color:#6b7280; font-weight:500; opacity:0.95; }
.preview-open { background: #ff6b96; color: white; border-radius: 999px; padding: 0.45rem 0.9rem; font-weight:700; box-shadow: 0 6px 18px rgba(255,107,150,0.28); transform-origin:center; transition: transform .12s ease; }
.template-preview:hover .preview-open { transform: scale(1.06); }
.envelope, .preview-open { cursor: pointer; }
@keyframes previewPulse { 0%,100%{ transform: scale(1); } 50%{ transform: scale(1.12) rotate(-6deg); } }
.preview-confetti { position:absolute; inset:0; pointer-events:none; overflow:visible; }
.confetti-piece { position:absolute; width:0.7rem; height:0.7rem; border-radius:50%; opacity:0.95; }
.error-overlay{position:fixed;left:10px;right:10px;bottom:10px;background:rgba(0,0,0,0.75);color:#fff;padding:10px;border-radius:8px;font-family:Segoe UI,system-ui,Arial, sans-serif;z-index:10000;display:none;max-height:40vh;overflow:auto}
.error-overlay h4{margin:0 0 6px 0;font-size:13px}
.error-overlay pre{white-space:pre-wrap;font-size:12px;color:#ffdede;margin:0}

/* PRICE REVEAL PAGE */
#price-reveal{position:fixed;inset:0;background:linear-gradient(135deg,#ff6b9d 0%,#ee9ca7 50%,#ffdde1 100%);display:none;z-index:9998;justify-content:center;align-items:center;flex-direction:column;padding:2rem;overflow:hidden}
#price-reveal::before{content:'';position:absolute;inset:0;background:radial-gradient(circle at 20% 50%, rgba(255,255,255,.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(255,255,255,.08) 0%, transparent 50%);pointer-events:none}
#price-reveal.show{display:flex}
.price-container{position:relative;z-index:10}
.price-box{background:linear-gradient(180deg, #ffffff 0%, #fff5f8 100%);border-radius:28px;padding:4rem 3rem;text-align:center;box-shadow:0 40px 100px rgba(225,29,72,.25), 0 15px 50px rgba(0,0,0,.1), inset 0 1px 0 rgba(255,255,255,.8);animation:priceGrow 900ms cubic-bezier(.13,.66,.33,1) forwards;backdrop-filter:blur(10px);border:2px solid rgba(255,255,255,.6);max-width:580px;width:90%;position:relative}
.price-box::before{content:'';position:absolute;inset:-2px;border-radius:28px;background:linear-gradient(135deg, #ff69b4, #ff1493, #ff69b4, #ff6b96);opacity:0;animation:priceGlow 3s ease-in-out infinite;pointer-events:none}
.price-icon{font-size:6rem;margin-bottom:1.8rem;animation:priceFloat 2.8s ease-in-out infinite;display:inline-block;filter:drop-shadow(0 8px 16px rgba(225,29,72,.3))}
.price-title{font-size:2.4rem;color:#b91c4a;font-weight:800;margin-bottom:0.8rem;text-shadow:0 6px 20px rgba(185,28,74,.2);letter-spacing:-0.5px}
.price-subtitle{font-size:1rem;color:#e11d48;font-weight:500;margin-bottom:1.6rem;opacity:0.9;letter-spacing:1px;text-transform:uppercase}
.price-text{font-size:1.5rem;color:#b91c4a;font-weight:700;margin-bottom:2.5rem;line-height:1.8;background:linear-gradient(135deg, #ff6b96, #e11d48);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.price-btn{background:linear-gradient(135deg,#ff6b96,#ff1493);color:white;border:none;padding:1.2rem 3rem;font-size:1.1rem;font-weight:800;border-radius:999px;cursor:pointer;transition:all 300ms cubic-bezier(.25,.46,.45,.94);box-shadow:0 12px 35px rgba(255,26,147,.35);position:relative;overflow:hidden;letter-spacing:0.5px}
.price-btn::before{content:'';position:absolute;inset:0;background:linear-gradient(120deg, transparent, rgba(255,255,255,.3), transparent);transform:translateX(-100%);animation:shine 2s infinite}
.price-btn:hover{transform:translateY(-3px) scale(1.08);box-shadow:0 18px 50px rgba(255,26,147,.5)}
.price-btn:active{transform:translateY(-1px)}

/* DECORATIVE STARS */
.price-star{position:absolute;font-size:1.2rem;opacity:0;animation:starTwinkle 3s ease-in-out infinite}
.price-star:nth-child(1){top:15%;left:10%;animation-delay:0s}
.price-star:nth-child(2){top:20%;right:12%;animation-delay:0.6s}
.price-star:nth-child(3){bottom:20%;left:8%;animation-delay:1.2s}
.price-star:nth-child(4){bottom:15%;right:10%;animation-delay:1.8s}
.price-heart{position:absolute;font-size:1.3rem;opacity:0.6;animation:heartFloat 4s ease-in-out infinite}
.price-heart:nth-child(5){top:25%;right:15%;animation-delay:0s}
.price-heart:nth-child(6){bottom:25%;left:5%;animation-delay:1s}
.price-heart:nth-child(7){top:60%;right:5%;animation-delay:2s}

@keyframes priceGrow{from{opacity:0;transform:scale(0.5) rotate(-5deg)}to{opacity:1;transform:scale(1) rotate(0deg)}}
@keyframes priceFloat{0%,100%{transform:translateY(0) rotateZ(0deg)}50%{transform:translateY(-16px) rotateZ(8deg)}}
@keyframes priceGlow{0%,100%{opacity:0}50%{opacity:0.6}}
@keyframes starTwinkle{0%,100%{opacity:0}50%{opacity:0.8}}
@keyframes heartFloat{0%{opacity:0;transform:translateY(20px)}50%{opacity:0.8;transform:translateY(-20px)}100%{opacity:0;transform:translateY(-40px)}}
@keyframes shine{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
</style>
</head>
<body>

<!-- INTRO -->
<div id="intro">
  <div class="intro-wrap">
    <div class="intro-veil" aria-hidden="true"></div>
    <div class="intro-vignette" aria-hidden="true"></div>
    <div class="envelope">üíå</div>
    <div class="intro-title">For Shamsham</div>
    <h1>Tap to Open Your Valentine Surprise</h1>
    <div class="intro-sub">A little world of love, just for you ‚ú®</div>
    <div class="intro-flowers" aria-hidden="true"></div>
    <div class="template-preview" title="Preview: Blooming Hearts (click to open)">
      <div class="preview-left">
        <div class="preview-icon">üå∏</div>
        <div>
          <div class="preview-text">Blooming Hearts</div>
          <div class="preview-sub">A sparkling surprise inside ‚Äî tap to open</div>
        </div>
      </div>
      <div class="preview-open">Open ‚Üí</div>
      <div class="preview-confetti" aria-hidden="true"></div>
    </div>
    <div style="height:6vh"></div>
  </div>
</div>

<!-- MUSIC -->
<!-- MUSIC -->
<audio id="music" loop preload="auto">
  <source src="Audio.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

<!-- BLOOMING FLOWERS -->
<div class="flower" style="left:10%"><div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="center"></div></div>
<div class="flower" style="left:80%; animation-delay:10s"><div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="center"></div></div>

<!-- FLOWER BOUQUET -->
<div class="bouquet">
  <div class="flowers">
    <div class="flower-head">üåπ</div>
    <div class="flower-head">üå∏</div>
    <div class="flower-head">üå∫</div>
    <div class="flower-head">üåª</div>
    <div class="flower-head">üå∑</div>
    <div class="flower-head">üåπ</div>
  </div>
  <div class="bouquet-stem">
    <div class="bouquet-stems">
      <div class="stem"></div>
      <div class="stem"></div>
      <div class="stem"></div>
    </div>
  </div>
  <div class="ribbon"></div>
</div>

<!-- CARD -->
<div class="card" id="card">
  <h1>Happy Valentine‚Äôs Day Shamsham ‚ù§Ô∏è</h1>
  <div class="names">From Tomtom</div>
  <img src="image.jpg" class="photo">
  <div id="text" class="message"></div>
  <button class="exit-btn" onclick="exitLove()">Exit ‚ùå</button>
</div>

<!-- OUTRO -->
<div id="outro">
  <h2>Before You Exit... üíï</h2>
  <p id="outroText">You mean the world to me. Thank you for all the love and laughter you bring to my life. I can't wait to create more beautiful memories with you. Until next time, keep smiling! üåπ</p>
  <div class="outro-buttons">
    <button class="back-btn" onclick="goBackToCard()">Back üí≠</button>
    <button class="goodbye-btn" onclick="confirmExit()">Goodbye üëã</button>
  </div>

  <!-- OUTRO: MINI-GAME (inside outro card) -->
  <div id="outro-game" style="display:none;margin-top:1rem;">
    <div class="game-area">
      <div style="display:flex;align-items:center;gap:0.8rem;justify-content:center;width:100%">
        <div class="game-score">Score: <span id="gameScore">0</span></div>
        <div id="gameTimer">Time: 20s</div>
        <div style="flex:1"></div>
        <button id="startGameBtn" class="back-btn">Start Game üéÆ</button>
        <button id="stopGameBtn" class="goodbye-btn" style="display:none">Stop</button>
      </div>
      <div class="game-playfield" id="gamePlayfield" aria-hidden="true"></div>
      <div id="gameResult" style="display:none" class="game-final">You scored <strong id="finalScore">0</strong> ‚Äî <button class="back-btn" id="playAgainBtn">Play Again</button></div>
    </div>
  </div>
</div>

<!-- PRICE REVEAL PAGE -->
<div id="price-reveal">
	<div class="price-star">‚ú®</div>
	<div class="price-star">‚≠ê</div>
	<div class="price-star">‚ú®</div>
	<div class="price-star">‚≠ê</div>
	<div class="price-heart">üíï</div>
	<div class="price-heart">üíó</div>
	<div class="price-heart">üíï</div>
	<div class="price-container">
		<div id="price-claim-wrapper" style="display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2rem">
			<!-- CLAIM GAME VIEW -->
			<div id="price-claim-game" style="display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1.5rem">
				<div style="font-size:2rem;font-weight:800;color:white;text-shadow:0 4px 12px rgba(0,0,0,.3)">Claim Your Prize!</div>
				<div style="font-size:1.1rem;color:rgba(255,255,255,.9);font-weight:600">Progress: <span id="priceClaimPercent">0</span>%</div>
				<div style="width:280px;height:24px;background:rgba(255,255,255,.2);border-radius:12px;overflow:hidden;border:2px solid white;box-shadow:0 4px 12px rgba(0,0,0,.2)">
					<div id="priceClaimBar" style="width:0%;height:100%;background:linear-gradient(90deg,#ff6b96,#ff1493);transition:width 200ms ease"></div>
				</div>
				<button id="priceClaimBtn" style="padding:1.2rem 2.5rem;font-size:1.3rem;font-weight:800;background:linear-gradient(135deg,#ff6b96,#ff1493);color:white;border:none;border-radius:15px;cursor:pointer;box-shadow:0 10px 30px rgba(0,0,0,.3);transition:all 200ms;margin-top:1rem" onmousedown="this.style.transform='scale(0.95)'" onmouseup="this.style.transform='scale(1)'" onclick="priceClaimClick()">üíù CLAIM NOW üíù</button>
			</div>
			<!-- PRIZE REVEALED VIEW -->
			<div id="price-claim-reveal" style="display:none;text-align:center">
				<div class="price-box">
					<div class="price-icon">üíé</div>
					<div class="price-title">Your Prize! üíñ</div>
					<div class="price-text">ILOVEYOUU MY LOVE!</div>
					<button class="price-btn" onclick="closePriceReveal()">Close</button>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- TEMPLATE SELECTOR -->
<div id="template-select">
  <h2>Choose Your Message üíù</h2>
  <div class="template-options">
    <button class="template-btn active" onclick="selectTemplate(0)">
      üåπ Romantic
      <small>A heartfelt goodbye message</small>
    </button>
    <button class="template-btn" onclick="selectTemplate(1)">
      üíù Passionate
      <small>Deep and emotional farewell</small>
    </button>
    <button class="template-btn" onclick="selectTemplate(2)">
      ‚ú® Sweet
      <small>Tender and gentle goodbye</small>
    </button>
    <button class="template-btn" onclick="selectTemplate(3)">
      üé≠ Playful
      <small>Fun and light-hearted message</small>
    </button>
  </div>
  <div class="outro-buttons">
    <button class="back-btn" onclick="goBackToCard()">Back üí≠</button>
    <button class="goodbye-btn" onclick="showOutro()">Continue ‚Üí</button>
  </div>
</div>

<script>
// Defensive element bindings and runtime error overlay
const intro = document.getElementById('intro');
const card = document.getElementById('card');
const outro = document.getElementById('outro');
const templateSelect = document.getElementById('template-select');
const text = document.getElementById('text');
const music = document.getElementById('music');

// Music toggle (visible if autoplay is blocked) ‚Äî created once
const _musicToggle = document.createElement('button');
_musicToggle.id = 'musicToggle';
_musicToggle.innerText = 'üîà';
_musicToggle.title = 'Play / Pause music';
_musicToggle.style.cssText = 'position:fixed;right:18px;top:18px;z-index:10005;padding:10px 12px;border-radius:12px;border:none;background:linear-gradient(90deg,#ff9ac3,#ff5e9a);color:white;font-size:18px;cursor:pointer;box-shadow:0 6px 20px rgba(0,0,0,.18);display:none';
document.body.appendChild(_musicToggle);
_musicToggle.addEventListener('click', async ()=>{
  try{
    if(!music) return;
    if(music.paused){
      await music.play();
      _musicToggle.innerText = 'üîä';
    } else {
      music.pause();
      _musicToggle.innerText = 'üîà';
    }
  }catch(err){
    showError('Audio play blocked: ' + (err && err.message ? err.message : String(err)));
  }
});

// create an on-screen error panel so you can see runtime errors without opening devtools
const _err = document.createElement('div'); _err.className='error-overlay'; _err.id='__errorOverlay';
_err.innerHTML = '<h4>Runtime errors</h4><pre id="__errorText"></pre>';
document.body.appendChild(_err);
function showError(msg){ try{ document.getElementById('__errorText').textContent = String(msg); _err.style.display='block'; }catch(e){ console.error(msg); } }
window.addEventListener('error', e=>{ showError(e.message + '\nat ' + (e.filename||'') + ':' + (e.lineno||'') + ':' + (e.colno||'')); });
window.addEventListener('unhandledrejection', ev=>{ showError('Unhandled Rejection: ' + (ev.reason && ev.reason.stack ? ev.reason.stack : String(ev.reason))); });

// FALLING ROSES
for(let i=0;i<25;i++){
 let r=document.createElement('div'); r.className='rose'; r.innerHTML='üåπ';
 r.style.left=Math.random()*100+'vw';
 r.style.animationDuration=(6+Math.random()*6)+'s';
 r.style.fontSize=(20+Math.random()*30)+'px';
 document.body.appendChild(r);
}

// SPARKLES
for(let i=0;i<30;i++){
 let s=document.createElement('div'); s.className='sparkle';
 s.style.left=Math.random()*100+'vw'; s.style.top=Math.random()*100+'vh';
 document.body.appendChild(s);
}

// INTRO: live blooming flowers while the intro screen is visible
let introFlowerInterval;
function spawnIntroFlower(){
  const container=document.querySelector('.intro-flowers');
  if(!container) return;
  const f=document.createElement('div'); f.className='intro-flower';
  const left = 8 + Math.random()*84; // keep inside edges
  f.style.left = left+'vw';
  const petals = 5 + Math.floor(Math.random()*3);
  for(let p=0;p<petals;p++){
    const pet=document.createElement('div'); pet.className='intro-petal';
    const angle = (360/petals)*p + (Math.random()*10-5);
    pet.style.transform = `translateX(-50%) rotate(${angle}deg) scale(0.2)`;
    pet.style.animation = `petalOpen 700ms ease ${p*80}ms forwards, petalFloat ${1800 + Math.random()*1200}ms linear ${800 + p*60}ms forwards`;
    f.appendChild(pet);
  }
  const c=document.createElement('div'); c.className='intro-center';
  c.style.animation = 'introBloom 900ms ease forwards';
  f.appendChild(c);
  f.style.animation = 'introBloom 2200ms ease forwards';
  container.appendChild(f);
  // remove after animation
  setTimeout(()=>{ f.remove(); }, 3800);
}
function startIntroFlowers(){
  stopIntroFlowers();
  spawnIntroFlower();
  introFlowerInterval = setInterval(spawnIntroFlower, 800 + Math.random()*600);
}
function stopIntroFlowers(){
  if(introFlowerInterval) { clearInterval(introFlowerInterval); introFlowerInterval=null; }
  document.querySelectorAll('.intro-flowers .intro-flower').forEach(n=>n.remove());
}

// start while intro is visible
startIntroFlowers();

// TEMPLATE PREVIEW: confetti burst and control
let previewConfettiInterval;
function spawnPreviewConfetti(){
  const container = document.querySelector('.preview-confetti');
  if(!container) return;
  const count = 10 + Math.floor(Math.random()*6);
  const colors = ['#ff6b96','#ffd166','#ffb4c6','#f472b6','#fb7185'];
  for(let i=0;i<count;i++){
    const c=document.createElement('div'); c.className='confetti-piece';
    const size = 6 + Math.random()*10;
    c.style.width = size+'px'; c.style.height = size+'px';
    c.style.background = colors[Math.floor(Math.random()*colors.length)];
    c.style.left = (40 + Math.random()*20) + '%';
    c.style.top = (30 + Math.random()*20) + '%';
    c.style.opacity = 1;
    const angle = -80 + Math.random()*160;
    const dist = 40 + Math.random()*40;
    c.style.transition = `transform ${900+Math.random()*800}ms cubic-bezier(.2,.8,.2,1), opacity 900ms linear`;
    container.appendChild(c);
    // trigger motion
    requestAnimationFrame(()=>{
      c.style.transform = `translate(${Math.cos(angle)*dist}px, ${Math.sin(angle)*dist - 40}px) rotate(${Math.random()*360}deg)`;
      c.style.opacity = 0;
    });
    setTimeout(()=>{ c.remove(); }, 1900);
  }
}
function startPreviewConfetti(){ stopPreviewConfetti(); spawnPreviewConfetti(); previewConfettiInterval = setInterval(spawnPreviewConfetti, 1400 + Math.random()*1200); }
function stopPreviewConfetti(){ if(previewConfettiInterval){ clearInterval(previewConfettiInterval); previewConfettiInterval=null; } document.querySelectorAll('.preview-confetti .confetti-piece').forEach(n=>n.remove()); }

// start preview confetti while intro is visible
startPreviewConfetti();

// SOFT FLOATING HEARTS FOR INTRO
let introHeartInterval;
function spawnIntroHeart(){
  const root = document.getElementById('intro');
  if(!root) return;
  const h = document.createElement('div'); h.className='intro-heart'; h.innerHTML='üíï';
  const left = 12 + Math.random()*76;
  h.style.left = left + 'vw';
  h.style.bottom = (8 + Math.random()*18) + 'vh';
  h.style.fontSize = (14 + Math.random()*18) + 'px';
  root.appendChild(h);
  requestAnimationFrame(()=>{ h.style.transform = 'translateY(-24vh)'; h.style.opacity = 0; });
  setTimeout(()=>{ h.remove(); }, 3200);
}
function startIntroHearts(){ stopIntroHearts(); spawnIntroHeart(); introHeartInterval = setInterval(spawnIntroHeart, 700 + Math.random()*800); }
function stopIntroHearts(){ if(introHeartInterval){ clearInterval(introHeartInterval); introHeartInterval=null; } document.querySelectorAll('.intro-heart').forEach(n=>n.remove()); }
// ensure hearts run while intro visible
startIntroHearts();

// bind specific clicks so name/title remain interactive
const _env = document.querySelector('.envelope');
if(_env){ _env.addEventListener('click', e=>{ e.stopPropagation(); startLove(); }); }
const _previewBtn = document.querySelector('.preview-open');
if(_previewBtn){ _previewBtn.addEventListener('click', e=>{ e.stopPropagation(); startLove(); }); }

// FLOATING HEARTS
function launchHearts(){
 for(let i=0;i<40;i++){
  let h=document.createElement('div'); h.className='heart'; h.innerHTML='‚ù§Ô∏è';
  h.style.left=Math.random()*100+'vw'; h.style.top='100vh';
  h.style.fontSize=(20+Math.random()*30)+'px';
  document.body.appendChild(h);
  setTimeout(()=>{ h.remove(); }, 5000);
 }
}

// ROMANTIC MESSAGE
const msg=`To Shamsham, you are the light in my life, the joy in my heart, and the reason I smile every day. 
Every moment with you feels like magic, and my love for you grows deeper with each passing day.
You make the world brighter, warmer, and more beautiful just by being in it. 
Happy Valentine‚Äôs Day ‚ù§Ô∏è I adore you endlessly.`;

let i=0;let selectedTemplate=0;

const templates=[
  {
    title: 'Before You Exit... üíï',
    text: 'You mean the world to me. Thank you for all the love and laughter you bring to my life. I can\'t wait to create more beautiful memories with you. Until next time, keep smiling! üåπ'
  },
  {
    title: 'My Dearest... ‚ù§Ô∏è',
    text: 'Your love has transformed my life in ways I never imagined possible. Every heartbeat is a reminder of how deeply I adore you. You are my soulmate, my home, and my forever. I love you endlessly. üíï'
  },
  {
    title: 'Sweet Love... üå∏',
    text: 'With you, I\'ve found my greatest joy and my truest love. Thank you for being the reason I smile every single day. You make life beautiful just by being in it. All my love to you. üíñ'
  },
  {
    title: 'Hey Shamsham! üòò',
    text: 'You make me laugh, you make me happy, and you make every day an adventure! So grab a hug because this is from me to you. Thanks for being amazing! Can\'t wait to see you again! üéâ‚ù§Ô∏è'
  }
];

function selectTemplate(index){
  selectedTemplate=index;
  document.querySelectorAll('.template-btn').forEach((btn,i)=>{
    btn.classList.toggle('active',i===index);
  });
}

function showOutro(){
  document.getElementById('template-select').style.display='none';
  outro.style.display='block';
  document.getElementById('outro-game').style.display='block';
  document.getElementById('outroText').innerText=templates[selectedTemplate].text;
  document.querySelector('#outro h2').innerText=templates[selectedTemplate].title;
}

function type(){
 if(i<msg.length){ text.innerHTML+=msg[i]; i++; setTimeout(type,35); }
 else { launchHearts(); }
}

// START ANIMATION
function startLove(){
 stopIntroFlowers();
 stopPreviewConfetti();
 stopIntroHearts();
 intro.style.display='none';
 card.style.display='block';
 if(music && music.play) music.play().then(()=>{ _musicToggle.style.display='inline-block'; _musicToggle.innerText='üîä'; }).catch(err=>{ showError('Audio play blocked: '+ (err && err.message ? err.message : String(err))); _musicToggle.style.display='inline-block'; });
 type();
}

// EXIT FUNCTION - SHOW TEMPLATE SELECTOR
function exitLove(){
 card.style.display='none';
 document.getElementById('template-select').style.display='block';
}

// GO BACK TO CARD
function goBackToCard(){
  outro.style.display='none';
  stopOutroGame();
  document.getElementById('template-select').style.display='none';
  card.style.display='block';
}

// CONFIRM EXIT
function confirmExit(){
 outro.style.display='none';
  stopOutroGame();
 document.getElementById('template-select').style.display='none';
 intro.style.display='flex';
 music.pause();
 music.currentTime=0;
 text.innerHTML='';
 i=0;
 startIntroFlowers();
 startPreviewConfetti();
 startIntroHearts();
}

// OUTRO GAME LOGIC: Catch Hearts
let outroGameInterval, outroSpawnInterval, outroTimeLeft=20, outroScore=0;
const gameScoreEl = () => document.getElementById('gameScore');
const gameTimerEl = () => document.getElementById('gameTimer');
const gamePlayfield = () => document.getElementById('gamePlayfield');
function spawnOutroHeart(){
  const field = gamePlayfield(); if(!field) return;
  const h = document.createElement('div'); h.className='game-heart'; h.innerHTML='üíñ';
  const x = Math.random()*(field.clientWidth-28);
  const y = Math.random()*(field.clientHeight-28);
  h.style.left = x+'px'; h.style.top = y+'px';
  field.appendChild(h);
  // float animation
  requestAnimationFrame(()=>{ h.style.transform = 'translateY(-18px)'; });
  const removeAfter = 3500 + Math.random()*1000;
  const tid = setTimeout(()=>{ if(h.parentNode) h.remove(); clearTimeout(tid); }, removeAfter);
  h.addEventListener('click', e=>{ outroScore+=1; updateOutroScore(); h.remove(); });
}

// BALLOON POP (alternative game for template 3)
let balloonIntervals = [];
function spawnBalloon(){
  const field = gamePlayfield(); if(!field) return;
  const b = document.createElement('div'); b.className='game-heart'; b.innerHTML='üéà';
  const size = 18 + Math.random()*28;
  const x = Math.random()*(field.clientWidth - size);
  b.style.left = x+'px'; b.style.bottom = '-40px'; b.style.fontSize = size+'px'; b.style.top = (field.clientHeight + 40) + 'px';
  field.appendChild(b);
  // animate upward
  requestAnimationFrame(()=>{ b.style.transition = 'transform 4000ms linear, opacity 4000ms'; b.style.transform = `translateY(-${field.clientHeight + 80}px)`; b.style.opacity = 0; });
  const removeAfter = 4200;
  const tid = setTimeout(()=>{ if(b.parentNode) b.remove(); clearTimeout(tid); }, removeAfter);
  b.addEventListener('click', e=>{ outroScore+=2; updateOutroScore(); b.remove(); });
}

function startBalloonGame(){ stopOutroGame(); outroScore=0; outroTimeLeft=20; updateOutroScore(); updateOutroTimer(); document.getElementById('gameResult').style.display='none'; document.getElementById('startGameBtn').style.display='none'; document.getElementById('stopGameBtn').style.display='inline-block';
  // spawn balloons periodically
  const id = setInterval(spawnBalloon, 700);
  balloonIntervals.push(id);
  outroGameInterval = setInterval(()=>{ outroTimeLeft--; updateOutroTimer(); if(outroTimeLeft<=0) endOutroGame(); }, 1000);
}

function stopBalloonGame(){ balloonIntervals.forEach(id=>clearInterval(id)); balloonIntervals = []; const field=gamePlayfield(); if(field) field.innerHTML=''; document.getElementById('startGameBtn').style.display='inline-block'; document.getElementById('stopGameBtn').style.display='none'; if(outroGameInterval){ clearInterval(outroGameInterval); outroGameInterval=null; } }

function updateOutroScore(){ const s = document.getElementById('gameScore'); if(s) s.innerText = outroScore; }
function updateOutroTimer(){ const t = document.getElementById('gameTimer'); if(t) t.innerText = 'Time: ' + outroTimeLeft + 's'; }
function startOutroGame(){ stopOutroGame(); outroScore=0; outroTimeLeft=20; updateOutroScore(); updateOutroTimer(); document.getElementById('gameResult').style.display='none'; document.getElementById('startGameBtn').style.display='none'; document.getElementById('stopGameBtn').style.display='inline-block';
  // choose game based on selected template
  if(selectedTemplate===3){ // playful -> balloon pop
    startBalloonGame();
    return;
  }
  outroSpawnInterval = setInterval(spawnOutroHeart, 600);
  outroGameInterval = setInterval(()=>{ outroTimeLeft--; updateOutroTimer(); if(outroTimeLeft<=0) endOutroGame(); }, 1000);
}
let priceClaimProgress = 0;
function priceClaimClick(){
  priceClaimProgress += 20;
  if(priceClaimProgress >= 100) priceClaimProgress = 100;
  document.getElementById('priceClaimPercent').innerText = priceClaimProgress;
  document.getElementById('priceClaimBar').style.width = priceClaimProgress + '%';
  if(priceClaimProgress >= 100){
    // Show revealed price box
    document.getElementById('price-claim-game').style.display = 'none';
    document.getElementById('price-claim-reveal').style.display = 'flex';
  }
}
function stopOutroGame(){ try{ if(outroSpawnInterval){ clearInterval(outroSpawnInterval); outroSpawnInterval=null; } if(outroGameInterval){ clearInterval(outroGameInterval); outroGameInterval=null; } const field = gamePlayfield(); if(field) field.innerHTML=''; document.getElementById('startGameBtn').style.display='inline-block'; document.getElementById('stopGameBtn').style.display='none'; }catch(e){ console.error(e); }}
function endOutroGame(){ stopOutroGame(); document.getElementById('finalScore').innerText = outroScore; document.getElementById('gameResult').style.display='flex'; document.getElementById('startGameBtn').style.display='inline-block'; document.getElementById('stopGameBtn').style.display='none'; 
  // show price reveal page after game ends
  setTimeout(()=>{ showPriceRevealPage(); }, 1000);
}

function showPriceRevealPage(){
  priceClaimProgress = 0;
  document.getElementById('priceClaimPercent').innerText = '0';
  document.getElementById('priceClaimBar').style.width = '0%';
  document.getElementById('price-claim-game').style.display = 'flex';
  document.getElementById('price-claim-reveal').style.display = 'none';
  const priceReveal = document.getElementById('price-reveal');
  if(priceReveal){ priceReveal.classList.add('show'); }
}

function closePriceReveal(){
  const priceReveal = document.getElementById('price-reveal');
  if(priceReveal){ priceReveal.classList.remove('show'); }
}

// bind buttons
document.addEventListener('click', function bindOutroGame(e){
  if(document.getElementById('startGameBtn')){
    document.getElementById('startGameBtn').addEventListener('click', ()=>{
      // start appropriate game for selected template
      if(selectedTemplate===3) startBalloonGame(); else startOutroGame();
    });
    document.getElementById('stopGameBtn').addEventListener('click', ()=>{ if(selectedTemplate===3) endOutroGame(); else endOutroGame(); });
    document.getElementById('playAgainBtn').addEventListener('click', ()=>{ if(selectedTemplate===3) startBalloonGame(); else startOutroGame(); });
  }
  document.removeEventListener('click', bindOutroGame);
});
</script>
</body>
</html>
